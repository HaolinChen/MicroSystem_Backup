
#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#include <math.h>
#include "matrix.h"

#define data_Num 360//气体传感器个数（The number of rows in the matrix）
#define label_Num 12 //采样点个数（The number of columns in the matrix.）
#define feature_dim 15
#define pi 3.141592654
double c_dataset[data_Num][1] = {0.00436401,
-0.00006104,
-0.00006104,
-0.00256348,
-0.00512695,
-0.00131226,
0.00006104,
0.00054932,
0.00228882,
0.00152588,
0.00219727,
0.00073242,
-0.00524902,
-0.00112915,
-0.00408936,
-0.00210571,
0.00088501,
0.00012207,
0.00408936,
0.00027466,
0.00057983,
0.00039673,
-0.00216675,
-0.00064087,
-0.00259399,
-0.00146484,
-0.00219727,
0.00076294,
0.00189209,
0.00473022,
0.00436401,
-0.00006104,
-0.00006104,
-0.00256348,
-0.00512695,
-0.00131226,
0.00006104,
0.00054932,
0.00228882,
0.00152588,
0.00219727,
0.00073242,
-0.00524902,
-0.00112915,
-0.00408936,
-0.00210571,
0.00088501,
0.00012207,
0.00408936,
0.00027466,
0.00057983,
0.00039673,
-0.00216675,
-0.00064087,
-0.00259399,
-0.00146484,
-0.00219727,
0.00076294,
0.00189209,
0.00473022,
0.00436401,
-0.00006104,
-0.00006104,
-0.00256348,
-0.00512695,
-0.00131226,
0.00006104,
0.00054932,
0.00228882,
0.00152588,
0.00219727,
0.00073242,
-0.00524902,
-0.00112915,
-0.00408936,
-0.00210571,
0.00088501,
0.00012207,
0.00408936,
0.00027466,
0.00057983,
0.00039673,
-0.00216675,
-0.00064087,
-0.00259399,
-0.00146484,
-0.00219727,
0.00076294,
0.00189209,
0.00473022,
0.00085449,
0.00228882,
-0.00268555,
-0.00299072,
-0.00436401,
-0.00143433,
-0.00308228,
0.00363159,
0.00173950,
0.00033569,
0.00039673,
-0.00091553,
-0.00067139,
-0.00317383,
-0.00366211,
-0.00097656,
-0.00213623,
0.00085449,
0.00408936,
0.00152588,
0.00134277,
0.00067139,
-0.00057983,
-0.00189209,
-0.00299072,
-0.00271606,
0.00173950,
-0.00021362,
0.00582886,
0.00241089,
0.00067139,
-0.00064087,
-0.00241089,
-0.00012207,
-0.00280762,
-0.00399780,
0.00039673,
0.00192261,
0.00405884,
0.00131226,
0.00003052,
0.00039673,
-0.00128174,
-0.00433350,
-0.00033569,
-0.00357056,
0.00122070,
0.00167847,
0.00234985,
0.00387573,
-0.00024414,
0.00033569,
-0.00186157,
-0.00506592,
-0.00189209,
0.00274658,
0.00088501,
0.00085449,
0.00292969,
0.00228882,
0.00061035,
-0.00085449,
-0.00170898,
-0.00299072,
-0.00442505,
-0.00305176,
0.00262451,
0.00363159,
0.00366211,
0.00042725,
0.00277710,
-0.00381470,
-0.00399780,
-0.00296021,
-0.00308228,
-0.00271606,
0.00354004,
0.00173950,
0.00466919,
0.00106812,
0.00103760,
-0.00170898,
-0.00128174,
-0.00195313,
-0.00048828,
-0.00219727,
0.00195313,
0.00305176,
0.00128174,
0.00097656,
0.00015259,
-0.00350952,
-0.00192261,
-0.00320435,
-0.00332642,
0.00164795,
0.00378418,
0.00469971,
0.00103760,
0.00302124,
-0.00024414,
-0.00244141,
0.00201416,
-0.00112915,
-0.00354004,
0.00299072,
0.00195313,
0.00222778,
0.00357056,
-0.00033569,
0.00064087,
-0.00253296,
-0.00222778,
-0.00341797,
-0.00076294,
0.00073242,
0.00595093,
0.04309082,
0.07119751,
0.00616455,
0.00631714,
-0.00088501,
-0.03253174,
-0.06326294,
-0.01141357,
0.00970459,
0.00677490,
0.03961182,
0.10662842,
-0.07141113,
-0.04733276,
-0.04092407,
0.02130127,
-0.02813721,
0.09298706,
0.07507324,
-0.09423828,
-0.05004883,
-0.02603149,
0.06332397,
0.14529419,
-0.03140259,
-0.19924927,
-0.01269531,
0.00210571,
0.22106934,
0.11492920,
0.12695313,
0.17675781,
0.13363647,
0.03005981,
-0.07714844,
-0.13369751,
-0.13461304,
-0.10223389,
-0.04364014,
0.03680420,
0.17770386,
0.25180054,
0.16333008,
-0.00643921,
0.00912476,
-0.01248169,
-0.07736206,
0.13565063,
0.15545654,
-0.09948730,
-0.19305420,
-0.06640625,
0.08038330,
0.03848267,
0.03384399,
0.06762695,
0.04879761,
0.03225708,
0.00070190,
-0.05123901,
-0.04913330,
-0.00469971,
0.01751709,
0.03591919,
0.00637817,
-0.00006104,
-0.00207520,
-0.00720215,
-0.00454712,
-0.01940918,
0.00964355,
-0.02804565,
0.00192261,
-0.00866699,
0.00335693,
0.01687622,
0.01068115,
0.00186157,
0.01354980,
-0.02194214,
0.02639771,
0.03125000,
0.00601196,
0.09442139,
-0.08477783,
-0.22283936,
0.18807983,
0.01647949,
-0.09002686,
0.03289795,
0.05712891,
0.12411499,
-0.07229614,
-0.13287354,
-0.03732300,
-0.03976440,
-0.16107178,
0.10650635,
0.06115723,
-0.04244995,
-0.08761597,
0.04162598,
-0.00103760,
0.08645630,
-0.01760864,
-0.01873779,
-0.11172485,
-0.00756836,
-0.05151367,
0.07376099,
-0.04302979,
0.03924561,
0.10928345,
0.01080322,
0.02474976,
-0.01022339,
0.04190063,
0.00531006,
-0.00607300,
0.02938843,
-0.00146484,
-0.01162720,
0.00784302,
-0.03103638,
0.00497437,
-0.03100586,
-0.10989380,
-0.04989624,
-0.06713867,
-0.04449463,
0.04931641,
0.07736206,
0.00726318,
0.03567505,
0.07165527,
0.07299805,
0.07250977,
0.03402710,
0.02005005,
0.03768921,
0.02841187,
0.02758789,
0.00686646,
-0.01947021,
-0.03219604,
-0.03091431,
-0.02508545,
0.02612305,
0.04510498,
0.04904175,
0.03732300,
0.00054932,
-0.03231812
};
double c_label[label_Num][1] = {    -1.00000000,
-1.00000000,
-1.00000000,
-1.00000000,
-1.00000000,
-1.00000000,
1.00000000,
1.00000000,
1.00000000,
1.00000000,
1.00000000,
1.00000000
};
double f_feature[15][1] = {15,30,45,60,75,90,105,120,135,150,165,180,195,210,225};
int main()
{
    printf("Hello world!\n");
    int frame_num = 12; // how many frames you want to test
    int subframe_size = 2; // for the ULPS stage with 250Hz
    int frame_size = 2*feature_dim;
    double feature_vector[frame_num][feature_dim];// final feature vector
    double frame_each[frame_size][1];// the current frame
    int i,j,t,T,subT;
    for(T=0;T<frame_num;T++) //每次算一帧
    {
        int j_start = T*frame_size;
        double featurenow = 0 ;
        int framenow = 0;
        double y_mid[subframe_size][1]; // middle value
        for(i=0;i<subframe_size;i++) // initialization
        {
            y_mid[i][1] = 0;
        }
        for(j=j_start;j<j_start+frame_size;j++)// give value to current frame
        {
            frame_each[j-j_start][1] = c_dataset[j][1];
        }
        /********************ULPS*******************/
        for(subT=0;subT<feature_dim;subT++)
        {
            for(t=0;t<subframe_size;t++)
            {
                framenow = subT * subframe_size + t;
                y_mid[t][1] = frame_each[framenow][1];
            }
            for(t=0;t<subframe_size;t++)
            {
                featurenow = featurenow + fabs(y_mid[t][1])*fabs(y_mid[t][1]);
            }
            feature_vector[T][subT] = featurenow ;
        }
        /*******************************************/
    }
    Matirx*  mat_feature = Matrix_gen(frame_num,feature_dim,&feature_vector[0][0]);
    printf(" The Feature Vector of 12 frames \n");
	M_print(mat_feature);
    return 0;
}

